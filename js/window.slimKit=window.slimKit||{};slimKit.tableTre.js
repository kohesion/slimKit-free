window.slimKit=window.slimKit||{};slimKit.tableTree=function(q,r){var n;var h=this;r=r||{};var j=r.openedDepth||1;var e=null;var p=parseInt(r.indent)||30;switch(typeof q){case"string":q=document.getElementById(objTable);break;case"undefined":console.error("table is a required parameter");break}n=q.querySelectorAll.bind(q);q.style.webkitUserSelect="none";q.style.mozUserSelect="none";e=q;var l=e.getElementsByTagName("SPAN");var d=[];var g;var b;var o;for(var f=0;f<l.length;f++){if(l[f].className==="tableTreeControl"){d.push(l[f]);l[f].parentNode.removeChild(l[f])}}for(f in d){d[f].parentNode.removeChild(d[f])}a();var m;(m=function(w,v){var s,u,t;if(w){u=n('tr[parentItemReference="'+w+'"]')}else{u=n("tr:not([parentItemReference])")}for(t=0;t<u.length;t++){u[t].setAttribute("depth",v);(s=u[t].getAttribute("itemReference"))&&m(s,v+1)}})(null,0);g={};b=q.tBodies[0].rows;for(f=0;f<b.length;f++){if(b[f].getAttribute("parentItemReference")){g[b[f].getAttribute("parentItemReference")]=1;(parseInt(b[f].getAttribute("depth"))>j)&&(b[f].style.display="none")}}this.toJSON=function(x,s){var t,w,u,v;x=x||0;s=s||{};w=x?n('tr[parentItemReference="'+x+'"]'):n("tr:not([parentItemReference])");for(u=0;u<w.length;u++){if(t=w[u].getAttribute("itemReference")){v=s[t.toString()]={};v.rowData=Array.prototype.map.call(w[u].cells,function(i){return i.innerText});this.toJSON(t,v)}}return s};for(f=0;f<b.length;f++){tempSpan=document.createElement("SPAN");if(!b[f].cells.length){tempCell=b[f].insertCell(0);tempCell.innerHTML="&nbsp;";tempCell.setAttribute("itemReference",0)}tempCell=b[f].cells[0];tempCell.insertBefore(tempSpan,tempCell.childNodes[0]);tempSpan.style.display="inline-block";tempSpan.style.marginRight="5px";tempSpan.style.width=p+"px";tempSpan.style.fontFamily="courier new, fixed-width";tempSpan.style.whiteSpace="nowrap";tempSpan.className="tableTreeControl";if(g[b[f].getAttribute("itemReference")]){tempSpan.innerHTML=(b[f].getAttribute("depth")<j)?"[-]":"[+]";tempSpan.style.cursor="pointer";tempSpan.addEventListener("click",function(){h.clickHandler(this.parentNode.parentNode)})}else{tempSpan.innerHTML="&nbsp;&nbsp;&nbsp;"}if(b[f].getAttribute("depth")){b[f].cells[0].childNodes[0].style.marginLeft=(parseInt(b[f].getAttribute("depth"))*p)+"px"}}this.clickHandler=function(i){if(i.cells[0].childNodes[0].innerHTML.indexOf("+")>-1){this.expand(i)}else{this.contract(i)}window.tableMouseInteraction&&tableMouseInteraction.unclick()};this.expand=function(i){trPointer=i;while(trPointer.nextElementSibling){trPointer=trPointer.nextElementSibling;if(trPointer.getAttribute("parentItemReference")==i.getAttribute("itemReference")){trPointer.style.display="block";trPointer.cells[0].childNodes[0].style.marginLeft=(parseInt(trPointer.getAttribute("depth"))*p)+"px"}}i.cells[0].childNodes[0].innerHTML="[-]"};this.contract=function(i){var s=i;while(s.nextElementSibling){s=s.nextElementSibling;if(s.cells.length){if(s.getAttribute("parentItemReference")==i.getAttribute("itemReference")){s.style.display="none";if(s.cells[0].childNodes[0].innerHTML.indexOf("-")>-1){this.contract(s)}}}}i.cells[0].childNodes[0].innerHTML="[+]"};function a(){var i=e.rows;for(var s=1;s<i.length-1;s++){if((parseInt(i[s+1].getAttribute("depth"))>parseInt(i[s].getAttribute("depth")))&&(i[s].getAttribute("itemReference")!==i[s+1].getAttribute("parentItemReference"))){tableTree.rowMove(i[s+1],k(i[s+1].getAttribute("parentItemReference")).rowIndex+1)}}}function k(t){var s=e.rows;for(var u=0;u<s.length;u++){if(s[u].getAttribute("itemReference")==t.toString()){return(s[u])}}}function c(w,v){var t=w.parentNode.parentNode.insertRow(v);t.setAttribute("depth",w.getAttribute("depth"));t.setAttribute("itemReference",w.getAttribute("itemReference"));t.setAttribute("parentItemReference",w.getAttribute("parentItemReference"));for(var u=0;u<w.cells.length;u++){var s=t.insertCell(u);s.innerHTML=w.cells[u].innerHTML;s.style.cssText=w.cells[u].style.cssText}w.parentNode.removeChild(w)}};